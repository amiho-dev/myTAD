<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>myTAD - Account Management</title>

    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-base: #040610;
            --bg-alt: #070c1a;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.72);
            --text-muted: rgba(255, 255, 255, 0.55);
            --accent-primary: #5c7cfa;
            --accent-secondary: #9d6bff;
            --accent-tertiary: #f472b6;
            --accent-success: #34d399;
            --accent-warning: #fbbf24;
            --accent-danger: #f87171;
            --glass: rgba(255, 255, 255, 0.08);
            --glass-light: rgba(255, 255, 255, 0.06);
            --border: rgba(255, 255, 255, 0.16);
            --border-light: rgba(255, 255, 255, 0.08);
            --shadow-lg: 0 28px 90px rgba(10, 12, 28, 0.65);
            --shadow-md: 0 18px 40px rgba(10, 12, 28, 0.55);
            --shadow-soft: 0 12px 30px rgba(92, 124, 250, 0.25);
            --radius-lg: 30px;
            --radius-md: 22px;
            --radius-sm: 16px;
            --transition-snappy: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: radial-gradient(circle at top left, rgba(92, 124, 250, 0.25), transparent 58%),
                        radial-gradient(circle at 80% 20%, rgba(251, 191, 36, 0.22), transparent 62%),
                        linear-gradient(135deg, var(--bg-base), var(--bg-alt));
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            position: relative;
            overflow: hidden;
        }

        .background-layers {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-gradient, .bg-noise, .bg-grid {
            position: absolute;
            inset: 0;
        }

        .bg-gradient {
            background: radial-gradient(circle at 20% 25%, rgba(92, 124, 250, 0.25), transparent 60%),
                        radial-gradient(circle at 85% 30%, rgba(244, 114, 182, 0.18), transparent 55%),
                        radial-gradient(circle at 50% 80%, rgba(157, 107, 255, 0.24), transparent 60%);
            opacity: 0.75;
        }

        .bg-noise {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="180" height="180" viewBox="0 0 180 180"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="1.15" numOctaves="2" stitchTiles="stitch"/></filter><rect width="180" height="180" filter="url(%23n)" opacity="0.18"/></svg>');
            mix-blend-mode: soft-light;
            opacity: 0.4;
        }

        .bg-grid {
            background-image: linear-gradient(rgba(255, 255, 255, 0.04) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
            background-size: 60px 60px;
            opacity: 0.25;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(110px);
            opacity: 0.45;
            animation: float 30s ease-in-out infinite;
            pointer-events: none;
        }

        .orb-1 {
            width: 620px;
            height: 620px;
            top: -240px;
            left: -200px;
            background: rgba(92, 124, 250, 0.55);
        }

        .orb-2 {
            width: 520px;
            height: 520px;
            top: 60%;
            right: -220px;
            background: rgba(157, 107, 255, 0.5);
            animation-delay: 4s;
        }

        .orb-3 {
            width: 720px;
            height: 720px;
            bottom: -320px;
            left: 32%;
            background: rgba(244, 114, 182, 0.45);
            animation-delay: 9s;
        }

        @keyframes float {
            0%, 100% { transform: translate3d(0, 0, 0) scale(1); }
            25% { transform: translate3d(40px, -30px, 0) scale(1.06); }
            55% { transform: translate3d(-50px, 20px, 0) scale(0.94); }
            80% { transform: translate3d(30px, 30px, 0) scale(1.03); }
        }

        .layout {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            display: grid;
            grid-template-columns: minmax(260px, 0.95fr) minmax(0, 1.05fr);
            gap: clamp(32px, 5vw, 64px);
            padding: clamp(28px, 6vw, 72px);
            align-items: stretch;
        }

        .hero-panel {
            display: flex;
            flex-direction: column;
            gap: 28px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.03));
            border: 1px solid rgba(255, 255, 255, 0.16);
            border-radius: var(--radius-lg);
            padding: clamp(28px, 4vw, 42px);
            backdrop-filter: blur(34px) saturate(140%);
            -webkit-backdrop-filter: blur(34px) saturate(140%);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .hero-panel::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top right, rgba(92, 124, 250, 0.25), transparent 60%);
            opacity: 0.8;
        }

        .hero-panel > * { position: relative; z-index: 1; }

        .logo-pill {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 18px;
            border-radius: 999px;
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.25), rgba(157, 107, 255, 0.25));
            border: 1px solid rgba(92, 124, 250, 0.35);
            letter-spacing: 0.18em;
            text-transform: uppercase;
            font-size: 0.75rem;
            font-weight: 600;
            width: fit-content;
        }

        .hero-title {
            font-size: clamp(2.1rem, 4vw, 3.2rem);
            margin: 0;
            line-height: 1.08;
            letter-spacing: -0.02em;
        }

        .hero-title span {
            background: linear-gradient(120deg, #89f7fe, #66a6ff 40%, #a78bfa);
            -webkit-background-clip: text;
                    background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-description {
            margin: 0;
            color: var(--text-secondary);
            font-size: 1rem;
            max-width: 420px;
        }

        .hero-insights {
            display: grid;
            gap: 18px;
            margin-top: 18px;
        }

        .insight-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .insight-card {
            flex: 1 1 160px;
            min-width: 150px;
            background: rgba(8, 12, 26, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: 22px;
            padding: 18px 20px;
            display: grid;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .insight-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top left, rgba(92, 124, 250, 0.26), transparent 70%);
            opacity: 0;
            transition: opacity 0.45s var(--transition-snappy);
        }

        .insight-card:hover::after { opacity: 1; }

        .insight-label {
            font-size: 0.78rem;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .insight-value {
            font-size: 1.45rem;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .insight-trend {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 0.78rem;
            background: rgba(52, 211, 153, 0.12);
            color: #34d399;
            width: fit-content;
        }

        .hero-timeline {
            display: grid;
            gap: 16px;
            margin-top: 22px;
        }

        .timeline-title {
            font-size: 0.85rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .hero-step {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 16px;
            align-items: start;
        }

        .step-marker {
            width: 38px;
            height: 38px;
            border-radius: 14px;
            background: rgba(92, 124, 250, 0.2);
            border: 1px solid rgba(92, 124, 250, 0.35);
            display: grid;
            place-items: center;
            font-weight: 600;
        }

        .step-body h3 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .step-body p {
            margin: 6px 0 0;
            color: var(--text-secondary);
            font-size: 0.92rem;
        }

        .hero-footer {
            margin-top: auto;
            padding-top: 18px;
            display: grid;
            gap: 18px;
        }

        .support-card {
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: var(--radius-md);
            padding: 18px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .support-card p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.92rem;
        }

        .main-shell {
            display: flex;
            position: relative;
        }

        .shell-card {
            background: rgba(10, 14, 28, 0.88);
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: var(--radius-lg);
            width: 100%;
            max-height: calc(100vh - clamp(64px, 9vw, 140px));
            min-height: min(900px, 100vh - clamp(64px, 9vw, 140px));
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .shell-scroll {
            padding: clamp(28px, 4vw, 48px);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(92, 124, 250, 0.35) transparent;
        }

        .shell-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .shell-scroll::-webkit-scrollbar-thumb {
            background: rgba(92, 124, 250, 0.45);
            border-radius: 8px;
        }

        .surface-stack {
            display: grid;
            gap: clamp(26px, 4vw, 40px);
        }

        .eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.1);
            letter-spacing: 0.22em;
            text-transform: uppercase;
            font-size: 0.7rem;
            color: var(--text-muted);
            width: fit-content;
        }

        .section-heading {
            display: grid;
            gap: 10px;
        }

        .section-heading h2,
        .section-heading h3 {
            margin: 0;
            letter-spacing: -0.01em;
        }

        .section-subtitle {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.98rem;
        }

        .auth-toggle {
            display: inline-flex;
            padding: 6px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 999px;
            gap: 6px;
        }

        .auth-toggle button {
            border: none;
            background: transparent;
            color: var(--text-secondary);
            padding: 10px 24px;
            border-radius: 999px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.35s var(--transition-snappy);
        }

        .auth-toggle button.active {
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.35), rgba(157, 107, 255, 0.35));
            color: var(--text-primary);
            box-shadow: 0 14px 32px rgba(92, 124, 250, 0.45);
        }

        .toast-stack {
            display: grid;
            gap: 12px;
            width: 100%;
        }

        .toast {
            position: relative;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 16px;
            align-items: center;
            padding: 16px 18px;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.14);
            background: rgba(10, 12, 28, 0.72);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            animation: fadeInUp 0.35s ease forwards;
        }

        .toast.success { border-color: rgba(52, 211, 153, 0.4); }
        .toast.error { border-color: rgba(248, 113, 113, 0.4); }
        .toast.info { border-color: rgba(92, 124, 250, 0.4); }

        .toast-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: currentColor;
        }

        .toast.success .toast-indicator { color: #34d399; }
        .toast.error .toast-indicator { color: #f87171; }
    .toast.info .toast-indicator { color: #5c7cfa; }

        .toast-body {
            display: grid;
            gap: 4px;
        }

        .toast-body strong {
            font-size: 0.92rem;
        }

        .toast-body span {
            font-size: 0.86rem;
            color: var(--text-secondary);
        }

        .toast-close {
            border: none;
            background: rgba(255, 255, 255, 0.06);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .toast-close:hover {
            background: rgba(255, 255, 255, 0.12);
            color: var(--text-primary);
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            padding: clamp(24px, 3vw, 32px);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
        }

        .tab-content.active {
            display: grid;
            gap: clamp(20px, 3vw, 28px);
            animation: fadeIn 0.45s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-grid {
            display: grid;
            gap: clamp(16px, 2vw, 22px);
        }

        .form-group {
            display: grid;
            gap: 10px;
        }

        label {
            font-size: 0.82rem;
            letter-spacing: 0.14em;
            text-transform: uppercase;
            color: var(--text-muted);
            font-weight: 600;
        }

        .form-input, textarea.form-input {
            width: 100%;
            padding: 16px 18px;
            border-radius: 22px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            background: rgba(10, 14, 28, 0.65);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.35s var(--transition-snappy);
            outline: none;
        }

        textarea.form-input {
            min-height: 90px;
            resize: vertical;
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.35);
        }

        .form-input:focus {
            border-color: rgba(92, 124, 250, 0.7);
            box-shadow: 0 18px 40px rgba(92, 124, 250, 0.35);
            transform: translateY(-1px);
        }

        .checkbox-line {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            font-size: 0.92rem;
            color: var(--text-secondary);
        }

        .checkbox-line input[type="checkbox"] {
            width: 18px;
            height: 18px;
            border-radius: 6px;
            accent-color: var(--accent-primary);
            cursor: pointer;
        }

        .btn {
            border: none;
            border-radius: 999px;
            padding: 14px 24px;
            font-size: 0.98rem;
            font-weight: 600;
            font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            letter-spacing: 0.01em;
            cursor: pointer;
            transition: all 0.35s var(--transition-snappy);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            inset: 0;
            opacity: 0;
            background: linear-gradient(120deg, rgba(255, 255, 255, 0.4), transparent 55%);
            transition: opacity 0.45s ease;
        }

        .btn:hover::after { opacity: 0.25; }

        .btn-primary {
            background: linear-gradient(135deg, #5c7cfa, #9d6bff);
            color: var(--text-primary);
            box-shadow: 0 20px 44px rgba(92, 124, 250, 0.45);
            border: 1px solid rgba(148, 163, 255, 0.45);
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 0 26px 64px rgba(92, 124, 250, 0.55);
        }

        .btn-accent {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.15));
            border: 1px solid rgba(59, 130, 246, 0.35);
            color: var(--text-primary);
        }

        .btn-warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.22), rgba(217, 119, 6, 0.18));
            border: 1px solid rgba(251, 191, 36, 0.4);
            color: #facc15;
        }

        .btn-danger {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.24), rgba(220, 38, 38, 0.2));
            border: 1px solid rgba(248, 113, 113, 0.4);
            color: #fca5a5;
        }

        .btn-ghost {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
        }

        .btn-ghost:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .auth-footer {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.92rem;
        }

        .auth-footer a {
            color: #c3d0ff;
            text-decoration: none;
            font-weight: 600;
        }

        .account-section {
            display: grid;
            gap: clamp(24px, 3.5vw, 36px);
        }

        .dashboard-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 18px;
            align-items: center;
        }

        .dashboard-title h2 {
            margin: 0;
            font-size: clamp(1.8rem, 3vw, 2.3rem);
        }

        .dashboard-title p {
            margin: 6px 0 0;
            color: var(--text-secondary);
        }

        .status-banner {
            display: flex;
            align-items: center;
            gap: 16px;
            background: linear-gradient(135deg, rgba(52, 211, 153, 0.18), rgba(16, 185, 129, 0.12));
            border: 1px solid rgba(52, 211, 153, 0.4);
            border-radius: var(--radius-md);
            padding: 16px 20px;
        }

        .status-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #34d399;
            box-shadow: 0 0 22px rgba(52, 211, 153, 0.65);
            position: relative;
        }

        .status-dot::after {
            content: '';
            position: absolute;
            inset: -6px;
            border-radius: 50%;
            border: 1px solid rgba(52, 211, 153, 0.5);
            opacity: 0.6;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: clamp(16px, 3vw, 24px);
        }

        .overview-card {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: var(--radius-md);
            padding: 22px;
            display: grid;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .overview-card::after {
            content: '';
            position: absolute;
            inset: -35% 45% auto -35%;
            height: 80%;
            background: radial-gradient(circle, rgba(92, 124, 250, 0.28), transparent 65%);
            opacity: 0;
            transition: opacity 0.45s ease;
        }

        .overview-card:hover::after { opacity: 1; }

        .overview-label {
            font-size: 0.78rem;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .overview-value {
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: -0.01em;
            word-break: break-word;
        }

        .overview-foot {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .stat-section {
            display: grid;
            gap: 18px;
        }

        .stat-tiles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 18px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(92, 124, 250, 0.25);
            border-radius: var(--radius-md);
            padding: 20px;
            display: grid;
            gap: 10px;
            position: relative;
            overflow: hidden;
            transition: transform 0.35s var(--transition-snappy), box-shadow 0.35s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-soft);
        }

        .stat-label {
            font-size: 0.78rem;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .stat-value {
            font-size: 1.6rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff, #5c7cfa);
            -webkit-background-clip: text;
                    background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .app-menu {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: var(--radius-md);
            padding: clamp(22px, 3vw, 28px);
            display: grid;
            gap: 20px;
        }

        .app-menu-items {
            display: grid;
            gap: 14px;
        }

        .app-menu-item {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 100%;
            padding: 16px 18px;
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(10, 14, 28, 0.6);
            color: var(--text-primary);
            text-align: left;
            cursor: pointer;
            transition: transform 0.25s var(--transition-snappy), box-shadow 0.3s ease;
        }

        .app-menu-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
        }

        .app-menu-icon {
            width: 42px;
            height: 42px;
            border-radius: 14px;
            display: grid;
            place-items: center;
            font-size: 1.35rem;
            background: rgba(92, 124, 250, 0.2);
            border: 1px solid rgba(92, 124, 250, 0.35);
        }

        .app-menu-content {
            display: grid;
            gap: 4px;
        }

        .app-menu-content strong {
            font-size: 1rem;
        }

        .app-menu-content span {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .app-menu-item--primary {
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.28), rgba(157, 107, 255, 0.22));
            border-color: rgba(92, 124, 250, 0.45);
        }

        .app-menu-item--primary .app-menu-icon {
            background: rgba(92, 124, 250, 0.3);
            border-color: rgba(92, 124, 250, 0.55);
        }

        .app-menu-item--danger {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.24), rgba(220, 38, 38, 0.18));
            border-color: rgba(248, 113, 113, 0.4);
        }

        .app-menu-item--danger .app-menu-icon {
            background: rgba(248, 113, 113, 0.25);
            border-color: rgba(248, 113, 113, 0.45);
        }

        .activity-wrap {
            display: block;
        }

        .activity-feed {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: var(--radius-md);
            padding: 22px;
            display: grid;
            gap: 18px;
            max-height: 260px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 14px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.07);
        }

        .activity-item:last-child { border-bottom: none; }

        .activity-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(92, 124, 250, 0.7);
            margin-top: 6px;
            box-shadow: 0 0 12px rgba(92, 124, 250, 0.6);
        }

        .activity-body h4 {
            margin: 0;
            font-size: 1rem;
        }

        .activity-body p {
            margin: 6px 0 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .activity-time {
            font-size: 0.8rem;
            color: var(--text-muted);
        }


        .manager-shell {
            display: grid;
            gap: 22px;
        }

        .manager-tabs {
            display: inline-flex;
            flex-wrap: wrap;
            gap: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 999px;
            padding: 6px;
        }

        .tab-btn {
            border: none;
            background: transparent;
            color: var(--text-secondary);
            padding: 10px 20px;
            border-radius: 999px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--transition-snappy);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.35), rgba(157, 107, 255, 0.35));
            color: var(--text-primary);
            box-shadow: 0 14px 34px rgba(92, 124, 250, 0.45);
        }

        .manager-grid {
            display: grid;
            gap: 22px;
        }

        .manager-card {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: var(--radius-md);
            padding: clamp(20px, 3vw, 26px);
            display: grid;
            gap: 18px;
        }

        .manager-columns {
            display: grid;
            gap: 18px;
        }

        .manager-columns.two {
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        }

        #searchResults {
            max-height: 280px;
            overflow-y: auto;
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: 14px;
            scrollbar-width: thin;
        }

        #searchResults::-webkit-scrollbar { width: 6px; }
        #searchResults::-webkit-scrollbar-thumb {
            background: rgba(92, 124, 250, 0.35);
            border-radius: 6px;
        }

        .search-result-entry {
            padding: 10px 12px;
            margin-bottom: 10px;
            border-left: 3px solid rgba(92, 124, 250, 0.55);
            background: rgba(92, 124, 250, 0.08);
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .search-result-entry:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-soft);
        }

        .owner-note {
            background: rgba(255, 215, 0, 0.12);
            border: 1px solid rgba(255, 215, 0, 0.35);
            border-radius: var(--radius-sm);
            padding: 14px;
            color: #facc15;
            font-size: 0.9rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.92rem;
            width: fit-content;
            cursor: pointer;
            transition: all 0.35s var(--transition-snappy);
        }

        .back-link:hover {
            transform: translateX(-4px);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: var(--shadow-soft);
        }

        .hidden { display: none !important; }

        @media (max-width: 1080px) {
            .layout {
                grid-template-columns: 1fr;
                min-height: auto;
            }

            .main-shell {
                order: -1;
            }

            .shell-card {
                max-height: none;
                min-height: auto;
            }
        }

        @media (max-width: 768px) {
            .layout {
                padding: 24px;
            }

            .shell-scroll {
                padding: 26px;
            }

            .hero-panel {
                padding: 24px;
            }

            .overview-grid,
            .feature-grid,
            .stat-tiles {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="background-layers">
        <div class="bg-gradient"></div>
        <div class="bg-grid"></div>
        <div class="bg-noise"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <div class="layout">
        <aside class="hero-panel">
            <div class="hero-header">
                <span class="logo-pill">myTAD CONTROL</span>
                <h1 class="hero-title">Command your account with <span>confidence</span>.</h1>
                <p class="hero-description">A polished, real-time cockpit for your myTAD identity. Switch accounts, adjust security, and manage users without leaving this page.</p>
            </div>

            <div class="hero-insights">
                <div class="insight-row">
                    <div class="insight-card">
                        <span class="insight-label">Security posture</span>
                        <span class="insight-value">Shielded</span>
                        <span class="insight-trend">Multi-layer checks active</span>
                    </div>
                    <div class="insight-card">
                        <span class="insight-label">Active sessions</span>
                        <span class="insight-value">4</span>
                        <span class="insight-trend">All secure</span>
                    </div>
                </div>
                <div class="insight-card">
                    <span class="insight-label">Instant actions</span>
                    <span class="insight-value">12 tools</span>
                    <span class="insight-trend">Everything in one view</span>
                </div>
            </div>

            <div class="hero-timeline">
                <span class="timeline-title">Elevate your account</span>
                <div class="hero-step">
                    <div class="step-marker">1</div>
                    <div class="step-body">
                        <h3>Sign in securely</h3>
                        <p>Dual-token protection rides through Cloudflare with zero friction.</p>
                    </div>
                </div>
                <div class="hero-step">
                    <div class="step-marker">2</div>
                    <div class="step-body">
                        <h3>Review smart metrics</h3>
                        <p>Glass dashboard keeps key stats and actions in focus.</p>
                    </div>
                </div>
                <div class="hero-step">
                    <div class="step-marker">3</div>
                    <div class="step-body">
                        <h3>Orchestrate users</h3>
                        <p>Promote admins, warn users, and resolve incidents in seconds.</p>
                    </div>
                </div>
            </div>

            <div class="hero-footer">
                <div class="support-card">
                    <p>Need a hand? Our team is here for high-priority operators.</p>
                    <a class="btn btn-ghost" href="mailto:support@thatoneamiho.cc">Contact Support</a>
                </div>
            </div>
        </aside>

        <main class="main-shell">
            <div class="shell-card">
                <div class="shell-scroll">
                    <section id="authSection" class="surface-stack">
                        <div class="section-heading">
                            <span class="eyebrow">Secure Access</span>
                            <h2>Access your command center</h2>
                            <p class="section-subtitle">Sign in to view your dashboard or spin up a fresh account with a single click.</p>
                        </div>

                        <div class="auth-toggle">
                            <button class="active" data-tab="login" onclick="switchAuthTab('login')">Login</button>
                            <button data-tab="register" onclick="switchAuthTab('register')">Register</button>
                        </div>

                        <div id="messageContainer" class="toast-stack"></div>

                        <div id="loginTab" class="tab-content active">
                            <form class="form-grid">
                                <div class="form-group">
                                    <label for="loginUsername">Username</label>
                                    <input type="text" id="loginUsername" class="form-input" placeholder="Enter your username">
                                </div>
                                <div class="form-group">
                                    <label for="loginPassword">Password</label>
                                    <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password">
                                </div>
                                <label class="checkbox-line">
                                    <input type="checkbox" id="rememberMe">
                                    Remember me for 30 days
                                </label>
                                <button type="button" class="btn btn-primary" onclick="handleLogin()">Sign in securely</button>
                            </form>

                            <div class="auth-footer">
                                Don't have an account yet?
                                <a href="#" onclick="switchAuthTab('register')">Create one</a>
                            </div>
                        </div>

                        <div id="registerTab" class="tab-content">
                            <form class="form-grid">
                                <div class="form-group">
                                    <label for="registerUsername">Username</label>
                                    <input type="text" id="registerUsername" class="form-input" placeholder="Choose your username">
                                </div>
                                <div class="form-group">
                                    <label for="registerEmail">Email</label>
                                    <input type="email" id="registerEmail" class="form-input" placeholder="Enter your email">
                                </div>
                                <div class="form-group">
                                    <label for="registerPassword">Password</label>
                                    <input type="password" id="registerPassword" class="form-input" placeholder="Create a password (6+ chars)">
                                </div>
                                <button type="button" class="btn btn-primary" onclick="handleRegister()">Create my account</button>
                            </form>

                            <div class="auth-footer">
                                Already joined?
                                <a href="#" onclick="switchAuthTab('login')">Return to login</a>
                            </div>
                        </div>
                    </section>

                    <section id="accountSection" class="surface-stack account-section hidden">
                        <header class="dashboard-header">
                            <div class="dashboard-title">
                                <span class="eyebrow">Dashboard</span>
                                <h2>Welcome back, <span id="displayUsername"></span></h2>
                                <p>Your centralized console for everything myTAD.</p>
                            </div>
                            <button class="btn btn-ghost" onclick="handleLogout()">Log out</button>
                        </header>

                        <div id="messageContainer2" class="toast-stack"></div>

                        <div class="status-banner">
                            <span class="status-dot"></span>
                            <div>All systems operational ‚Ä¢ Last sync <span id="lastSync">Just now</span></div>
                        </div>

                        <div class="overview-grid">
                            <article class="overview-card">
                                <span class="overview-label">Username</span>
                                <span class="overview-value" id="displayUsername2"></span>
                                <span class="overview-foot">Primary identity on record</span>
                            </article>
                            <article class="overview-card">
                                <span class="overview-label">Email</span>
                                <span class="overview-value" id="displayEmail"></span>
                                <span class="overview-foot">Where important alerts land</span>
                            </article>
                            <article class="overview-card">
                                <span class="overview-label">Session health</span>
                                <span class="overview-value">Protected</span>
                                <span class="overview-foot">All active sessions verified & secure</span>
                            </article>
                        </div>

                        <div class="stat-section">
                            <div class="section-heading">
                                <h3>Performance snapshot</h3>
                                <p class="section-subtitle">Key milestones update automatically as you explore.</p>
                            </div>
                            <div id="statsContainer" class="stat-tiles"></div>
                        </div>

                        <div class="app-menu">
                            <div class="section-heading">
                                <h3>Unified command menu</h3>
                                <p class="section-subtitle">Jump straight to the tools you need without leaving this view.</p>
                            </div>
                            <div class="app-menu-items">
                                <button type="button" class="app-menu-item app-menu-item--primary" onclick="openManagementFromMenu('profile')">
                                    <span class="app-menu-icon">üéõÔ∏è</span>
                                    <div class="app-menu-content">
                                        <strong>Control center</strong>
                                        <span>Fine-tune usernames, email aliases, and profile details.</span>
                                    </div>
                                </button>
                                <button type="button" class="app-menu-item" onclick="openManagementFromMenu('security')">
                                    <span class="app-menu-icon">ÔøΩ</span>
                                    <div class="app-menu-content">
                                        <strong>Security toolkit</strong>
                                        <span>Rotate passwords, protect sessions, and manage recovery.</span>
                                    </div>
                                </button>
                                <button type="button" class="app-menu-item" onclick="openManagementFromMenu('preferences')">
                                    <span class="app-menu-icon">üé®</span>
                                    <div class="app-menu-content">
                                        <strong>Preferences</strong>
                                        <span>Toggle notifications, privacy mode, and theme options.</span>
                                    </div>
                                </button>
                                <button type="button" id="appMenuAdmin" class="app-menu-item" style="display:none;" onclick="openManagementFromMenu('admin')">
                                    <span class="app-menu-icon">üëë</span>
                                    <div class="app-menu-content">
                                        <strong>Admin console</strong>
                                        <span>Search accounts, issue warnings, and adjust roles.</span>
                                    </div>
                                </button>
                                <button type="button" class="app-menu-item app-menu-item--danger" onclick="handleLogout()">
                                    <span class="app-menu-icon">ÔøΩ</span>
                                    <div class="app-menu-content">
                                        <strong>Sign out</strong>
                                        <span>Wrap up your session instantly across all devices.</span>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <div class="activity-wrap">
                            <div class="activity-feed">
                                <div class="section-heading">
                                    <h3>Activity feed</h3>
                                    <p class="section-subtitle">A curated view of the latest platform moves.</p>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-body">
                                        <h4>Real-time stats shipped</h4>
                                        <p>The dashboard now refreshes account stats after every login.</p>
                                        <span class="activity-time">2 minutes ago</span>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-body">
                                        <h4>Admin ban guard added</h4>
                                        <p>Admins can no longer be banned accidentally‚Äîfull protection enabled.</p>
                                        <span class="activity-time">15 minutes ago</span>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-dot"></div>
                                    <div class="activity-body">
                                        <h4>Cloudflare header fix</h4>
                                        <p>Authorization header fallback (X-Auth-Token) rolled out to production.</p>
                                        <span class="activity-time">1 hour ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="accountManagement" class="manager-shell hidden">
                            <div class="section-heading">
                                <span class="eyebrow">Control Center</span>
                                <h3>Fine-tune your account</h3>
                                <p class="section-subtitle">Update profile details, rotate passwords, tune preferences, or manage users if you're an admin.</p>
                            </div>

                            <div class="manager-tabs">
                                <button class="tab-btn active" onclick="switchMgmtTab('profile', event)">Profile</button>
                                <button class="tab-btn" onclick="switchMgmtTab('security', event)">Security</button>
                                <button class="tab-btn" onclick="switchMgmtTab('preferences', event)">Preferences</button>
                                <button class="tab-btn" id="adminTabBtn" style="display:none;" onclick="switchMgmtTab('admin', event)">Admin</button>
                            </div>

                            <div id="profileTab" class="tab-content active manager-grid">
                                <div class="manager-card">
                                    <h4>Update username</h4>
                                    <p class="section-subtitle">Give your profile a fresh handle instantly.</p>
                                    <input type="text" id="mgmtUsername" class="form-input" placeholder="New username">
                                    <button class="btn btn-primary" onclick="handleUpdateUsername()">Save username</button>
                                </div>
                                <div class="manager-card">
                                    <h4>Update email</h4>
                                    <p class="section-subtitle">Ensure recovery links arrive where you expect them.</p>
                                    <input type="email" id="mgmtEmail" class="form-input" placeholder="New email">
                                    <button class="btn btn-primary" onclick="handleUpdateEmail()">Save email</button>
                                </div>
                            </div>

                            <div id="securityTab" class="tab-content manager-grid">
                                <div class="manager-card">
                                    <h4>Rotate password</h4>
                                    <p class="section-subtitle">Keep attackers out with regular password updates.</p>
                                    <div class="manager-columns">
                                        <input type="password" id="currentPassword" class="form-input" placeholder="Current password">
                                        <input type="password" id="newPassword" class="form-input" placeholder="New password (6+ chars)">
                                        <input type="password" id="confirmNewPassword" class="form-input" placeholder="Confirm new password">
                                        <button class="btn btn-primary" onclick="handleChangePassword()">Update password</button>
                                    </div>
                                </div>
                                <div class="manager-card">
                                    <h4>Danger zone</h4>
                                    <p class="section-subtitle">Totally done? You can remove your account permanently.</p>
                                    <button class="btn btn-danger" onclick="handleDeleteAccount()">Delete account</button>
                                </div>
                            </div>

                            <div id="preferencesTab" class="tab-content manager-grid">
                                <div class="manager-card">
                                    <h4>Notification controls</h4>
                                    <div class="manager-columns">
                                        <label class="checkbox-line">
                                            <input type="checkbox" id="emailNotifications" onchange="savePreference('emailNotifications')">
                                            Email notifications
                                        </label>
                                        <label class="checkbox-line">
                                            <input type="checkbox" id="privacyMode" onchange="savePreference('privacyMode')">
                                            Privacy mode
                                        </label>
                                        <label class="checkbox-line">
                                            <input type="checkbox" id="darkTheme" onchange="savePreference('darkTheme')" checked>
                                            Dark theme
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div id="adminTab" class="tab-content manager-grid">
                                <div class="manager-card">
                                    <h4>Search users</h4>
                                    <p class="section-subtitle">Look up accounts instantly by username or email.</p>
                                    <input type="text" id="userSearchInput" class="form-input" placeholder="Search by username or email" oninput="searchUsers()">
                                    <div id="searchResults">
                                        <p style="color: var(--text-muted);">Type to search...</p>
                                    </div>
                                </div>

                                <div class="manager-card">
                                    <h4>Manage account</h4>
                                    <p class="section-subtitle">Reset credentials, toggle bans, or send warnings.</p>
                                    <div class="manager-columns two">
                                        <input type="text" id="adminTargetUser" class="form-input" placeholder="User ID">
                                        <div class="manager-columns">
                                            <input type="password" id="adminNewPassword" class="form-input" placeholder="New password (6+ chars)">
                                            <button class="btn btn-accent" onclick="handleAdminResetPassword()">Reset password</button>
                                        </div>
                                        <div class="manager-columns">
                                            <input type="email" id="adminNewEmail" class="form-input" placeholder="New email">
                                            <button class="btn btn-accent" onclick="handleAdminUpdateEmail()">Update email</button>
                                        </div>
                                        <div class="manager-columns two">
                                            <button class="btn btn-danger" onclick="handleAdminUserAction('ban')">Ban user</button>
                                            <button class="btn btn-primary" onclick="handleAdminUserAction('unban')">Unban user</button>
                                        </div>
                                        <textarea id="adminWarningMessage" class="form-input" placeholder="Warning message (5-500 chars)"></textarea>
                                        <button class="btn btn-warning" onclick="handleAdminSendWarning()">Send warning</button>
                                    </div>
                                </div>

                                <div id="ownerOnlySection" class="manager-card" style="display:none;">
                                    <h4>Owner controls</h4>
                                    <p class="section-subtitle">Promote or revoke admin privileges instantly.</p>
                                    <div class="manager-columns two">
                                        <div class="manager-columns">
                                            <input type="text" id="promoteTargetUser" class="form-input" placeholder="User ID">
                                            <button class="btn btn-primary" onclick="handleAddAdmin()">Promote to admin</button>
                                        </div>
                                        <div class="manager-columns">
                                            <input type="text" id="revokeTargetUser" class="form-input" placeholder="User ID">
                                            <button class="btn btn-danger" onclick="handleRevokeAdmin()">Revoke admin</button>
                                        </div>
                                    </div>
                                    <div class="owner-note">‚ö†Ô∏è Owner only: these controls stay locked to the primary account holder.</div>
                                </div>

                                <a class="back-link" onclick="hideManagement()">‚Üê Back to dashboard</a>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <script>
        const rootDomain = window.location.origin;
        const API_BASE_URL = `${rootDomain}/php`;

        function showMessage(message, type = 'info', target = 'auto') {
            const safeMessage = escapeHtml(message);
            const authSection = document.getElementById('authSection');
            const accountSection = document.getElementById('accountSection');

            let container = document.getElementById('messageContainer');
            if (target === 'account' || (target === 'auto' && accountSection && !accountSection.classList.contains('hidden'))) {
                container = document.getElementById('messageContainer2') || container;
            }

            if (!container) return;

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span class="toast-indicator"></span>
                <div class="toast-body">
                    <strong>${type === 'success' ? 'Success' : type === 'error' ? 'Heads up' : 'Reminder'}</strong>
                    <span>${safeMessage}</span>
                </div>
                <button class="toast-close" aria-label="Dismiss">&times;</button>
            `;

            const close = () => toast.remove();
            toast.querySelector('.toast-close').addEventListener('click', close);
            container.appendChild(toast);
            setTimeout(close, 5500);
        }

        function escapeHtml(text) {
            if (!text) return '';
            return String(text)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function showSuccess(message) {
            showMessage(message, 'success');
        }

        function showError(message) {
            showMessage(message, 'error');
        }

        function promptForPassword(actionDescription = 'continue') {
            const promptMessage = `Enter your password to ${actionDescription}.`;
            const password = prompt(promptMessage);

            if (password === null) {
                showMessage('Action cancelled.', 'info');
                return null;
            }

            if (!password.trim()) {
                showError('Password is required to continue.');
                return null;
            }

            return password.trim();
        }

        function updateAuthToggle(tab) {
            document.querySelectorAll('.auth-toggle button').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tab);
            });
        }

        function switchAuthTab(tab) {
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            if (!loginTab || !registerTab) return;

            loginTab.classList.remove('active');
            registerTab.classList.remove('active');
            const targetTab = document.getElementById(`${tab}Tab`);
            if (targetTab) targetTab.classList.add('active');
            updateAuthToggle(tab);
        }

        // Auth functions
        async function handleLogin() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            if (!username || !password) {
                showError('Please enter username and password');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/login.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password, remember_me: rememberMe })
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    showSuccess('Login successful!');
                    if (data.token) {
                        localStorage.setItem('token', data.token);
                    }
                    setTimeout(checkAuthStatus, 1500);
                } else {
                    const errorMessage = data.error || data.message || `Login failed (${response.status})`;
                    showError(errorMessage);
                }
            } catch (error) {
                console.error('Login error:', error);
                showError('Connection error: ' + error.message);
            }
        }

        async function handleRegister() {
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            if (!username || !email || !password) {
                showError('Please fill in all fields');
                return;
            }

            if (password.length < 6) {
                showError('Password must be at least 6 characters');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/register.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, email, password })
                });

                const data = await response.json();
                if (data.success) {
                    if (data.token) {
                        localStorage.setItem('token', data.token);
                    }

                    showSuccess('Account created! Logging in...');

                    document.getElementById('registerUsername').value = '';
                    document.getElementById('registerEmail').value = '';
                    document.getElementById('registerPassword').value = '';

                    setTimeout(checkAuthStatus, 1500);
                } else {
                    showError(data.error || 'Registration failed');
                }
            } catch (error) {
                console.error('Register error:', error);
                showError('Connection error');
            }
        }

        async function handleLogout() {
            try {
                await fetch(`${API_BASE_URL}/logout.php`, {
                    method: 'POST',
                    credentials: 'include'
                });
                showSuccess('Logged out');
                setTimeout(checkAuthStatus, 1500);
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        async function checkAuthStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/check-auth.php`, {
                    method: 'GET',
                    credentials: 'include'
                });

                const data = await response.json();
                if (data.authenticated) {
                    document.getElementById('authSection').classList.add('hidden');
                    document.getElementById('accountSection').classList.remove('hidden');
                    document.getElementById('displayUsername').textContent = data.username;
                    document.getElementById('displayUsername2').textContent = data.username;
                    document.getElementById('displayEmail').textContent = data.email;

                    loadStats();
                    checkAdmin(data.username);
                    loadPreferences();

                    const urlParams = new URLSearchParams(window.location.search);
                    const redirectUrl = urlParams.get('redirect');
                    if (redirectUrl) {
                        try {
                            const decodedUrl = decodeURIComponent(redirectUrl);
                            const redirectObj = new URL(decodedUrl);
                            const currentHostname = window.location.hostname;
                            const redirectHostname = redirectObj.hostname;

                            const isSafeDomain =
                                redirectHostname === currentHostname ||
                                redirectHostname.endsWith('.thatoneamiho.cc') ||
                                (currentHostname.endsWith('.thatoneamiho.cc') && redirectHostname.endsWith('.thatoneamiho.cc'));

                            if (isSafeDomain) {
                                setTimeout(() => {
                                    window.location.href = decodedUrl;
                                }, 500);
                            } else {
                                console.warn('Redirect blocked - unsafe domain:', redirectHostname);
                            }
                        } catch (e) {
                            console.warn('Invalid redirect URL:', redirectUrl);
                        }
                    }
                } else {
                    document.getElementById('authSection').classList.remove('hidden');
                    document.getElementById('accountSection').classList.add('hidden');
                    updateAuthToggle('login');
                }
            } catch (error) {
                console.error('Auth check error:', error);
            }
        }

        async function loadStats() {
            try {
                const username = document.getElementById('displayUsername').textContent;
                const response = await fetch(`${API_BASE_URL}/get-account-stats.php?username=${encodeURIComponent(username)}`, {
                    credentials: 'include'
                });
                const data = await response.json();
                if (data.success) {
                    const statsHTML = `
                        <div class="stat-card">
                            <div class="stat-label">Account created</div>
                            <div class="stat-value">${new Date(data.created_at).toLocaleDateString()}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Last login</div>
                            <div class="stat-value">${data.last_login ? new Date(data.last_login).toLocaleDateString() : 'Today'}</div>
                        </div>
                    `;
                    document.getElementById('statsContainer').innerHTML = statsHTML;
                }
            } catch (error) {
                console.error('Stats error:', error);
            }
        }

        function showManagement() {
            document.getElementById('accountOverview')?.classList?.add('hidden');
            document.getElementById('accountManagement').classList.remove('hidden');
        }

        function hideManagement() {
            document.getElementById('accountOverview')?.classList?.remove('hidden');
            document.getElementById('accountManagement').classList.add('hidden');
        }

        function openManagementFromMenu(tab) {
            showManagement();
            if (tab) {
                switchMgmtTab(tab);
            }
            document.getElementById('accountSection')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function switchMgmtTab(tab, evt) {
            document.querySelectorAll('#accountManagement .tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('#accountManagement .tab-btn').forEach(el => el.classList.remove('active'));

            const next = document.getElementById(`${tab}Tab`);
            if (next) next.classList.add('active');

            if (evt && evt.currentTarget) {
                evt.currentTarget.classList.add('active');
            }
        }

        async function handleUpdateUsername() {
            const newUsername = document.getElementById('mgmtUsername').value.trim();
            if (!newUsername) {
                showError('Please enter a new username');
                return;
            }

            const passwordConfirm = promptForPassword('update your username');
            if (!passwordConfirm) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/update-username.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: newUsername, password_confirmation: passwordConfirm })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Username updated!');
                    setTimeout(checkAuthStatus, 1500);
                } else {
                    showError(data.error || 'Failed to update username');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleUpdateEmail() {
            const newEmail = document.getElementById('mgmtEmail').value.trim();
            if (!newEmail) {
                showError('Please enter a new email');
                return;
            }

            const passwordConfirm = promptForPassword('update your email');
            if (!passwordConfirm) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/update-email.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: newEmail, password_confirmation: passwordConfirm })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Email updated!');
                    setTimeout(checkAuthStatus, 1500);
                } else {
                    showError(data.error || 'Failed to update email');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleChangePassword() {
            const current = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirm = document.getElementById('confirmNewPassword').value;

            if (!current || !newPass || !confirm) {
                showError('Please fill all password fields');
                return;
            }

            if (newPass.length < 6) {
                showError('New password must be at least 6 characters');
                return;
            }

            if (newPass !== confirm) {
                showError('New passwords do not match');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/update-password.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ current_password: current, new_password: newPass })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Password updated!');
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmNewPassword').value = '';
                } else {
                    showError(data.error || 'Failed to update password');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleDeleteAccount() {
            if (!confirm('‚ö†Ô∏è WARNING: This will permanently delete your account. Are you sure?')) return;
            if (!confirm('This action cannot be undone. Are you absolutely sure?')) return;

            const passwordConfirm = promptForPassword('delete your account');
            if (!passwordConfirm) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/delete-account.php`, {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password_confirmation: passwordConfirm })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Account deleted. Redirecting...');
                    setTimeout(checkAuthStatus, 2000);
                } else {
                    showError(data.error || 'Failed to delete account');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        function savePreference(prefName) {
            const prefs = JSON.parse(localStorage.getItem('userPrefs') || '{}');
            prefs[prefName] = document.getElementById(prefName).checked;
            localStorage.setItem('userPrefs', JSON.stringify(prefs));
            showSuccess('Preference saved!');
        }

        function loadPreferences() {
            const prefs = JSON.parse(localStorage.getItem('userPrefs') || '{}');
            if (prefs.emailNotifications !== undefined) {
                document.getElementById('emailNotifications').checked = prefs.emailNotifications;
            }
            if (prefs.privacyMode !== undefined) {
                document.getElementById('privacyMode').checked = prefs.privacyMode;
            }
            if (prefs.darkTheme !== undefined) {
                document.getElementById('darkTheme').checked = prefs.darkTheme;
            }
        }

        async function checkAdmin(username) {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/check-admin.php`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token
                    }
                });
                const data = await response.json();

                const adminTabButton = document.getElementById('adminTabBtn');
                const ownerOnlySection = document.getElementById('ownerOnlySection');
                const appMenuAdmin = document.getElementById('appMenuAdmin');

                if (data.is_admin) {
                    if (adminTabButton) adminTabButton.style.display = 'inline-flex';
                    if (appMenuAdmin) appMenuAdmin.style.display = 'flex';
                    if (ownerOnlySection) ownerOnlySection.style.display = 'none';

                    if (username === 'thatoneamiho') {
                        if (ownerOnlySection) ownerOnlySection.style.display = 'grid';
                    }
                } else {
                    if (adminTabButton) adminTabButton.style.display = 'none';
                    if (appMenuAdmin) appMenuAdmin.style.display = 'none';
                    if (ownerOnlySection) ownerOnlySection.style.display = 'none';
                }
            } catch (error) {
                console.error('Error checking admin status:', error);
                const adminTabButton = document.getElementById('adminTabBtn');
                const ownerOnlySection = document.getElementById('ownerOnlySection');
                const appMenuAdmin = document.getElementById('appMenuAdmin');
                if (adminTabButton) adminTabButton.style.display = 'none';
                if (ownerOnlySection) ownerOnlySection.style.display = 'none';
                if (appMenuAdmin) appMenuAdmin.style.display = 'none';
            }
        }

        async function searchUsers() {
            const searchTerm = document.getElementById('userSearchInput').value.trim();
            const resultsContainer = document.getElementById('searchResults');

            if (searchTerm.length < 1) {
                resultsContainer.style.display = 'none';
                resultsContainer.innerHTML = '<p style="color: var(--text-muted);">Type to search...</p>';
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/admin-get-users.php?search=${encodeURIComponent(searchTerm)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token
                    }
                });

                const data = await response.json();

                if (data.success && data.users && data.users.length > 0) {
                    let html = `<strong>Found ${data.users.length} user(s)</strong><hr style="margin: 10px 0; opacity: 0.15;">`;
                    data.users.forEach(user => {
                        const status = user.is_active ? '‚úì Active' : 'üö´ Banned';
                        const isAdmin = user.is_admin ? 'üëë Admin' : '';
                        html += `
                            <div class="search-result-entry" onclick="selectAdminUser('${user.username}', ${user.id}, ${user.is_admin ? 1 : 0})">
                                <div style="color: #ffd700; font-weight: 600;">${user.username}${isAdmin ? ' ' + isAdmin : ''}</div>
                                <div style="color: #ffb84d; font-size: 0.85rem;">ID: ${user.id} ‚Ä¢ ${status}</div>
                                <div style="color: var(--text-muted); font-size: 0.8rem;">üìß ${user.email}</div>
                            </div>
                        `;
                    });
                    resultsContainer.innerHTML = html;
                    resultsContainer.style.display = 'block';
                } else {
                    resultsContainer.innerHTML = '<p style="color: #f87171;">No users found matching your search.</p>';
                    resultsContainer.style.display = 'block';
                }
            } catch (error) {
                console.error('Search error:', error);
                resultsContainer.innerHTML = '<p style="color: #f87171;">Error searching users.</p>';
                resultsContainer.style.display = 'block';
            }
        }

        let selectedUserIsAdmin = false;

        function selectAdminUser(username, userId, isAdmin = 0) {
            document.getElementById('adminTargetUser').value = userId;
            selectedUserIsAdmin = isAdmin === 1 || isAdmin === true;
            showSuccess(`Selected user: ${username}${isAdmin ? ' (Admin)' : ''}`);
        }

        async function handleAdminResetPassword() {
            const targetUser = document.getElementById('adminTargetUser').value.trim();
            const newPassword = document.getElementById('adminNewPassword').value;

            if (!targetUser || !newPassword) {
                showError('Please enter user ID and new password');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            const adminPassword = promptForPassword('reset this user password');
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/admin-reset-password.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ user_id: userId, new_password: newPassword, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Password reset successfully!');
                    document.getElementById('adminNewPassword').value = '';
                    document.getElementById('adminTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to reset password');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleAdminUpdateEmail() {
            const targetUser = document.getElementById('adminTargetUser').value.trim();
            const newEmail = document.getElementById('adminNewEmail').value.trim();

            if (!targetUser || !newEmail) {
                showError('Please enter user ID and new email');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            const adminPassword = promptForPassword('change this user email');
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/admin-update-email.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ user_id: userId, email: newEmail, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('Email updated successfully!');
                    document.getElementById('adminNewEmail').value = '';
                    document.getElementById('adminTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to update email');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleAdminUserAction(action) {
            const targetUser = document.getElementById('adminTargetUser').value.trim();

            if (!targetUser) {
                showError('Please select a user first');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            const actionDescription = action === 'ban' ? 'ban this user' : action === 'unban' ? 'unban this user' : 'update this user';
            const adminPassword = promptForPassword(actionDescription);
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/admin-user-action.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ user_id: userId, action, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    document.getElementById('adminTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to perform action');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleAdminSendWarning() {
            const targetUser = document.getElementById('adminTargetUser').value.trim();
            const warningMessage = document.getElementById('adminWarningMessage').value.trim();

            if (!targetUser || !warningMessage) {
                showError('Please select a user and enter a warning message');
                return;
            }

            if (warningMessage.length < 5 || warningMessage.length > 500) {
                showError('Warning message must be 5-500 characters');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            const adminPassword = promptForPassword('send this warning');
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/admin-send-warning.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ user_id: userId, warning: warningMessage, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess(`Warning issued to ${data.username}`);
                    document.getElementById('adminWarningMessage').value = '';
                    document.getElementById('adminTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to send warning');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleAddAdmin() {
            const targetUser = document.getElementById('promoteTargetUser').value.trim();

            if (!targetUser) {
                showError('Please enter a user ID');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            const adminPassword = promptForPassword('promote this user');
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/manage-admin-role.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ action: 'grant', user_id: userId, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess(`${data.username} promoted to admin! ‚ú®`);
                    document.getElementById('promoteTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to promote user');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        async function handleRevokeAdmin() {
            const targetUser = document.getElementById('revokeTargetUser').value.trim();

            if (!targetUser) {
                showError('Please enter a user ID');
                return;
            }

            const userId = parseInt(targetUser, 10);
            if (!userId) {
                showError('Please enter a valid user ID');
                return;
            }

            if (!confirm('Are you sure you want to revoke admin privileges from this user?')) {
                return;
            }

            const adminPassword = promptForPassword('revoke this admin');
            if (!adminPassword) {
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/manage-admin-role.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Auth-Token': token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ action: 'revoke', user_id: userId, password_confirmation: adminPassword })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess(`Admin privileges revoked from ${data.username}`);
                    document.getElementById('revokeTargetUser').value = '';
                } else {
                    showError(data.error || 'Failed to revoke admin');
                }
            } catch (error) {
                showError('Connection error');
            }
        }

        checkAuthStatus();
    </script>
</body>
</html>
